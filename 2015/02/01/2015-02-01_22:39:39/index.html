<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>how to use ftrace to capture code path | 一個人的太平洋</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="BackgroundI have to deep dive into an networking issue today in my work environment. We have a good number of servers that are doing low latency transactions. It has been reported there are intermitte">
<meta property="og:type" content="article">
<meta property="og:title" content="how to use ftrace to capture code path">
<meta property="og:url" content="http://www.weiwangblog.com/2015/02/01/2015-02-01_22:39:39/index.html">
<meta property="og:site_name" content="一個人的太平洋">
<meta property="og:description" content="BackgroundI have to deep dive into an networking issue today in my work environment. We have a good number of servers that are doing low latency transactions. It has been reported there are intermitte">
<meta property="og:updated_time" content="2015-10-25T02:35:00.307Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="how to use ftrace to capture code path">
<meta name="twitter:description" content="BackgroundI have to deep dive into an networking issue today in my work environment. We have a good number of servers that are doing low latency transactions. It has been reported there are intermitte">
  
    <link rel="alternative" href="/atom.xml" title="一個人的太平洋" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">一個人的太平洋</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.weiwangblog.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2015-02-01_22:39:39" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/02/01/2015-02-01_22:39:39/" class="article-date">
  <time datetime="2015-02-02T04:39:39.000Z" itemprop="datePublished">2015-02-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tech/">tech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      how to use ftrace to capture code path
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Background">Background</h2><p>I have to deep dive into an networking issue today in my work environment. We have a good number of servers that are doing low latency transactions. It has been reported there are intermittent delay in transactions, which has cost us money.</p>
<p>Developper was able to reproduce the issue with some simple code doing client/server communication with TCP. I worked with networking team to capture network traffic with tcpdump on servers and at switch ports.</p>
<p>We found when the issue happens, there are SYN packet been sent at logical bonding, active physical ethernet port, but They don’t get acknowledged. The client server will retransmit the SYN for 4 times with increased delay in between, then give up. Interestingly, those SYN packets are not seen on the switch ports that are directly connected to the server!</p>
<h2 id="Things_to_look_for:">Things to look for:</h2><p>We know we don’t have any firewalls in-between those servers. But, we still manually test the port where we observed the failures, and as expected, the failure was not repeatable on the same port.</p>
<p>Things has been checked:</p>
<ul>
<li>Firewall rules between servers;</li>
<li>IP table rules;</li>
<li>Open file limits; (didn’t think this can be the cause for our issue but still checked, as socket already assigned)</li>
<li>Kernel setting for local port range (net.ipv4.ip_local_port_range) (didn’t think this can be the cause but still checked, as we’ve already get the port and TCP stack started using the port to send SYN message)</li>
</ul>
<p>Eventually I decided to capture the code path of the issue. While below was done only in my lab, but it may helps in many situations that we may need to understand what’s going on under the hook..</p>
<h2 id="How_do_I_capture_the_code_path">How do I capture the code path</h2><p>I made two small script to help me achieve this goal.</p>
<h3 id="Main_script_to_capture_the_code_path">Main script to capture the code path</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># cat ftrace.sh&#10;./sleepnc.sh &#38;&#10;pid_totrace=$!&#10;ps -ef | grep $&#123;pid_totrace&#125;&#10;&#10;echo $&#123;pid_totrace&#125; &#62; /sys/kernel/debug/tracing/set_ftrace_pid&#10;echo function_graph &#62; /sys/kernel/debug/tracing/current_tracer&#10;echo 1 &#62; /sys/kernel/debug/tracing/tracing_on&#10;echo ============================================= &#62; /dev/shm/xmlping.ftrace.out&#10;cat /sys/kernel/debug/tracing/trace_pipe &#62;&#62; /dev/shm/xmlping.ftrace.out &#38;&#10;cat_pid=$!&#10;sleep 4&#10;#do test here&#10;echo 0 &#62; /sys/kernel/debug/tracing/tracing_on&#10;kill -9 $cat_pid</span><br></pre></td></tr></table></figure>
<h3 id="Script_to_do_a_quick_client/server_tcp_communication-">Script to do a quick client/server tcp communication.</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># cat sleepnc.sh&#10;sleep 3&#10;echo test|nc  10.xx.xx.xx 9000</span><br></pre></td></tr></table></figure>
<p>And, at the server side, use nc -lk 9000 start a tcp listener.</p>
<p>I also use strace to capture at system call layer activities, which helps understanding the kernel code path greatly.</p>
<h2 id="The_result">The result</h2><h3 id="System_call_flow">System call flow</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.377780</span> munmap(<span class="number">0x7fd3682f9000</span>, <span class="number">51160</span>) = <span class="number">0</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.377997</span> brk(<span class="number">0</span>)      = <span class="number">0x1129000</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378086</span> brk(<span class="number">0x114a000</span>) = <span class="number">0x114a000</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378192</span> socket(PF_NETLINK, SOCK_RAW, <span class="number">0</span>) = <span class="number">3</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378296</span> bind(<span class="number">3</span>, &#123;sa_family=AF_NETLINK, pid=<span class="number">0</span>, groups=<span class="number">00000000</span>&#125;, <span class="number">12</span>) = <span class="number">0</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378399</span> getsockname(<span class="number">3</span>, &#123;sa_family=AF_NETLINK, pid=<span class="number">24036</span>, groups=<span class="number">00000000</span>&#125;, [<span class="number">12</span>]) = <span class="number">0</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378528</span> sendto(<span class="number">3</span>, <span class="string">"\24\0\0\0\26\0\1\3a\335\317T\0\0\0\0\0\0\0\0"</span>, <span class="number">20</span>, <span class="number">0</span>, &#123;sa_family=AF_NETLINK, pid=<span class="number">0</span>, groups=<span class="number">00000000</span>&#125;, <span class="number">12</span>) = <span class="number">20</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378661</span> recvmsg(<span class="number">3</span>, &#123;msg_name(<span class="number">12</span>)=&#123;sa_family=AF_NETLINK, pid=<span class="number">0</span>, groups=<span class="number">00000000</span>&#125;, msg_iov(<span class="number">1</span>)=[&#123;<span class="string">"0\0\0\0\24\0\2\0a\335\317T\344]\0\0\2\10\200\376\1\0\0\0\10\0\1\0\177\0\0\1"</span>..., <span class="number">4096</span>&#125;], msg_controllen=<span class="number">0</span>, msg_flags=<span class="number">0</span>&#125;, <span class="number">0</span>) = <span class="number">108</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378837</span> recvmsg(<span class="number">3</span>, &#123;msg_name(<span class="number">12</span>)=&#123;sa_family=AF_NETLINK, pid=<span class="number">0</span>, groups=<span class="number">00000000</span>&#125;, msg_iov(<span class="number">1</span>)=[&#123;<span class="string">"\24\0\0\0\3\0\2\0a\335\317T\344]\0\0\0\0\0\0\1\0\0\0\10\0\1\0\177\0\0\1"</span>..., <span class="number">4096</span>&#125;], msg_controllen=<span class="number">0</span>, msg_flags=<span class="number">0</span>&#125;, <span class="number">0</span>) = <span class="number">20</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.378991</span> close(<span class="number">3</span>)    = <span class="number">0</span></span><br><span class="line">*[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.379103</span> socket(PF_INET, SOCK_STREAM, IPPROTO_TCP) = <span class="number">3</span></span><br><span class="line">*[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.379203</span> fcntl(<span class="number">3</span>, F_GETFL) = <span class="number">0x2</span> (flags O_RDWR)</span><br><span class="line">*[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.379295</span> fcntl(<span class="number">3</span>, F_SETFL, O_RDWR|O_NONBLOCK) = <span class="number">0</span></span><br><span class="line">*[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.379388</span> connect(<span class="number">3</span>, &#123;sa_family=AF_INET, sin_port=htons(<span class="number">9000</span>), sin_addr=inet_addr(<span class="string">"10.142.208.17"</span>)&#125;, <span class="number">16</span>) = -<span class="number">1</span> EINPROGRESS (Operation now in progress)</span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.379525</span> select(<span class="number">4</span>, <span class="literal">NULL</span>, [<span class="number">3</span>], <span class="literal">NULL</span>, <span class="literal">NULL</span>) = <span class="number">1</span> (out [<span class="number">3</span>])</span><br><span class="line">*[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.428452</span> getsockopt(<span class="number">3</span>, SOL_SOCKET, SO_ERROR, [<span class="number">5366319056599121920</span>], [<span class="number">4</span>]) = <span class="number">0</span></span><br><span class="line">*[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.428569</span> fcntl(<span class="number">3</span>, F_SETFL, O_RDWR) = <span class="number">0</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.428678</span> poll([&#123;fd=<span class="number">3</span>, events=POLLIN&#125;, &#123;fd=<span class="number">0</span>, events=POLLIN&#125;], <span class="number">2</span>, -<span class="number">1</span>) = <span class="number">1</span> ([&#123;fd=<span class="number">0</span>, revents=POLLIN|POLLHUP&#125;])</span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.428799</span> read(<span class="number">0</span>, <span class="string">"test\n"</span>, <span class="number">2048</span>) = <span class="number">5</span></span><br><span class="line">*[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.428904</span> write(<span class="number">3</span>, <span class="string">"test\n"</span>, <span class="number">5</span>) = <span class="number">5</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.429018</span> poll([&#123;fd=<span class="number">3</span>, events=POLLIN&#125;, &#123;fd=<span class="number">0</span>, events=POLLIN&#125;], <span class="number">2</span>, -<span class="number">1</span>) = <span class="number">1</span> ([&#123;fd=<span class="number">0</span>, revents=POLLHUP&#125;])</span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.429134</span> shutdown(<span class="number">3</span>, <span class="number">1</span> <span class="comment">/* send */</span>) = <span class="number">0</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.429239</span> poll([&#123;fd=<span class="number">3</span>, events=POLLIN&#125;, &#123;fd=-<span class="number">1</span>&#125;], <span class="number">2</span>, -<span class="number">1</span>) = <span class="number">1</span> ([&#123;fd=<span class="number">3</span>, revents=POLLIN|POLLHUP&#125;])</span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.477426</span> read(<span class="number">3</span>, <span class="string">""</span>, <span class="number">2048</span>) = <span class="number">0</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.477531</span> shutdown(<span class="number">3</span>, <span class="number">0</span> <span class="comment">/* receive */</span>) = -<span class="number">1</span> ENOTCONN (Transport endpoint is not connected)</span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.477626</span> close(<span class="number">3</span>)    = <span class="number">0</span></span><br><span class="line">[pid <span class="number">24036</span>] <span class="number">15</span>:<span class="number">26</span>:<span class="number">09.477735</span> exit_group(<span class="number">0</span>) = ?</span><br></pre></td></tr></table></figure>
<h3 id="The_code_path">The code path</h3><p>There are two socket calls, the 2nd one is the one doing the netcat.</p>
<p>And I was able to capture the code path:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sys_socket() &#123;</span><br><span class="line"> <span class="number">22</span>)               |    sock_create() &#123;</span><br><span class="line"> <span class="number">22</span>)               |      __sock_create() &#123;</span><br><span class="line"> <span class="number">22</span>)               |        security_socket_create() &#123;</span><br><span class="line"> <span class="number">22</span>)   <span class="number">0.163</span> us    |          cap_socket_create();</span><br><span class="line"> <span class="number">22</span>)   <span class="number">0.520</span> us    |        &#125;</span><br><span class="line"> :::::::::(cut <span class="keyword">short</span> here)</span><br><span class="line"> <span class="number">22</span>)   <span class="number">0.163</span> us    |        _spin_lock();</span><br><span class="line"> <span class="number">22</span>)   <span class="number">0.544</span> us    |      &#125;</span><br><span class="line"> <span class="number">22</span>)   <span class="number">9.256</span> us    |    &#125;</span><br><span class="line"> <span class="number">22</span>) + <span class="number">28.162</span> us   |  &#125;</span><br></pre></td></tr></table></figure></p>
<p>And, you probably guessed, <strong>connect</strong> call is the system call actually sent SYN packet:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">sys_connect() &#123;</span><br><span class="line"><span class="number">22</span>)               |    sockfd_lookup_light() &#123;</span><br><span class="line"><span class="number">22</span>)   <span class="number">0.167</span> us    |      fget_light();</span><br><span class="line"><span class="number">22</span>)   <span class="number">0.507</span> us    |    &#125;</span><br><span class="line"><span class="number">22</span>)               |    move_addr_to_kernel() &#123;</span><br><span class="line"><span class="number">22</span>)   <span class="number">0.180</span> us    |      audit_sockaddr();</span><br><span class="line"><span class="number">22</span>)   <span class="number">0.518</span> us    |    &#125;</span><br><span class="line">::::::::(cut <span class="keyword">short</span> a lot!)</span><br><span class="line"><span class="number">22</span>)               |    security_socket_connect() &#123;</span><br><span class="line"><span class="number">12</span>)               |                        ip_output() &#123;</span><br><span class="line"><span class="number">12</span>)               |                          ip_finish_output() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.174</span> us    |                            skb_push();</span><br><span class="line"><span class="number">12</span>)               |                            dev_queue_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.189</span> us    |                              local_bh_disable();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.203</span> us    |                              bond_select_queue();</span><br><span class="line"><span class="number">12</span>)               |                              dev_hard_start_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)               |                                bond_start_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.163</span> us    |                                  _read_lock();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.170</span> us    |                                  _read_lock();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.166</span> us    |                                  _read_lock();</span><br><span class="line"><span class="number">12</span>)               |                                  bond_dev_queue_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)               |                                    dev_queue_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.392</span> us    |                                      local_bh_disable();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.193</span> us    |                                      _spin_lock();</span><br><span class="line"><span class="number">12</span>)               |                                      sch_direct_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.192</span> us    |                                        _spin_lock();</span><br><span class="line"><span class="number">12</span>)               |                                        dev_hard_start_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.272</span> us    |                                          dst_release();</span><br><span class="line"><span class="number">12</span>)               |                                          tg3_start_xmit() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.212</span> us    |                                            __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.165</span> us    |                                            __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.165</span> us    |                                            __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.196</span> us    |                                            tg3_tx_frag_set();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.186</span> us    |                                            _tg3_flag();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.163</span> us    |                                            _tg3_flag();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.167</span> us    |                                            _tg3_flag();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.198</span> us    |                                            __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.168</span> us    |                                            tg3_tx_frag_set();</span><br><span class="line"><span class="number">12</span>)               |                                            tg3_tx_skb_unmap() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.171</span> us    |                                              __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.171</span> us    |                                              __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.200</span> us    |                                              __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.166</span> us    |                                              __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">1.852</span> us    |                                            &#125;</span><br><span class="line"><span class="number">12</span>)               |                                            skb_copy() &#123;</span><br><span class="line"><span class="number">12</span>)               |                                              __alloc_skb() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.197</span> us    |                                                kmem_cache_alloc_node();</span><br><span class="line"><span class="number">12</span>)               |                                                  kmem_cache_alloc_node_trace() &#123;</span><br><span class="line"><span class="number">12</span>)               |                                                    cache_alloc_refill() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.215</span> us    |                                                      _spin_lock();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.192</span> us    |                                                      transfer_objects();</span><br><span class="line"><span class="number">12</span>)   <span class="number">1.603</span> us    |                                                    &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">2.122</span> us    |                                                  &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">2.470</span> us    |                                                &#125;</span><br><span class="line"><span class="number">12</span>)               |                                                ksize() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.163</span> us    |                                                  __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.502</span> us    |                                                &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">3.873</span> us    |                                              &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.182</span> us    |                                              skb_put();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.540</span> us    |                                              skb_copy_bits();</span><br><span class="line"><span class="number">12</span>)               |                                              copy_skb_header() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.186</span> us    |                                                __copy_skb_header();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.563</span> us    |                                              &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">6.329</span> us    |                                            &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.163</span> us    |                                            __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.166</span> us    |                                            __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.166</span> us    |                                            __phys_addr();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.166</span> us    |                                            tg3_tx_frag_set();</span><br><span class="line"><span class="number">12</span>)               |                                            consume_skb() &#123;</span><br><span class="line"><span class="number">12</span>)               |                                              __kfree_skb() &#123;</span><br><span class="line"><span class="number">12</span>)               |                                                skb_release_head_state() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.215</span> us    |                                                  sock_wfree();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.759</span> us    |                                                &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.223</span> us    |                                                skb_release_data();</span><br><span class="line"><span class="number">12</span>)   <span class="number">1.663</span> us    |                                              &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">2.098</span> us    |                                            &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.177</span> us    |                                            tg3_write32();</span><br><span class="line"><span class="number">12</span>) + <span class="number">16.869</span> us   |                                          &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">17.739</span> us   |                                        &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.230</span> us    |                                        _spin_lock();</span><br><span class="line"><span class="number">12</span>) + <span class="number">18.926</span> us   |                                      &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.184</span> us    |                                      local_bh_enable();</span><br><span class="line"><span class="number">12</span>) + <span class="number">21.848</span> us   |                                    &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">22.206</span> us   |                                  &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">23.623</span> us   |                                &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">24.057</span> us   |                              &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.184</span> us    |                              local_bh_enable();</span><br><span class="line"><span class="number">12</span>) + <span class="number">25.827</span> us   |                            &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">26.607</span> us   |                          &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">27.148</span> us   |                        &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">30.443</span> us   |                      &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">32.550</span> us   |                    &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">36.901</span> us   |                  &#125;</span><br><span class="line"><span class="number">12</span>)               |                  tcp_event_new_data_sent() &#123;</span><br><span class="line"><span class="number">12</span>)               |                    sk_reset_timer() &#123;</span><br><span class="line"><span class="number">12</span>)               |                      mod_timer() &#123;</span><br><span class="line"><span class="number">12</span>)               |                        lock_timer_base() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.200</span> us    |                          _spin_lock_irqsave();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.542</span> us    |                        &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.198</span> us    |                        idle_cpu();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.188</span> us    |                        _spin_lock();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.191</span> us    |                        internal_add_timer();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.180</span> us    |                        _spin_unlock_irqrestore();</span><br><span class="line"><span class="number">12</span>)   <span class="number">2.390</span> us    |                      &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">2.739</span> us    |                    &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">3.138</span> us    |                  &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">41.602</span> us   |                &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">41.948</span> us   |              &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">42.332</span> us   |            &#125;</span><br><span class="line"><span class="number">12</span>)               |            release_sock() &#123;</span><br><span class="line"><span class="number">12</span>)               |              _spin_lock_bh() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.848</span> us    |                local_bh_disable();</span><br><span class="line"><span class="number">12</span>)   <span class="number">1.193</span> us    |              &#125;</span><br><span class="line"><span class="number">12</span>)               |              _spin_unlock_bh() &#123;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.215</span> us    |                local_bh_enable_ip();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.554</span> us    |              &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">2.305</span> us    |            &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">60.734</span> us   |          &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">63.258</span> us   |        &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">63.631</span> us   |      &#125;</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.208</span> us    |      inotify_inode_queue_event();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.163</span> us    |      __fsnotify_parent();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.170</span> us    |      inotify_dentry_parent_queue_event();</span><br><span class="line"><span class="number">12</span>)   <span class="number">0.165</span> us    |      fsnotify();</span><br><span class="line"><span class="number">12</span>) + <span class="number">66.650</span> us   |    &#125;</span><br><span class="line"><span class="number">12</span>) + <span class="number">67.492</span> us   |  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Kernel_source_code">Kernel source code</h3> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/* Build a SYN and send it off. */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">tcp_connect</span><span class="params">(<span class="keyword">struct</span> sock *sk)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">        <span class="keyword">struct</span> tcp_sock *tp = tcp_sk(sk);</span><br><span class="line">        <span class="keyword">struct</span> sk_buff *buff;</span><br><span class="line">        <span class="keyword">int</span> err;</span><br><span class="line"> </span><br><span class="line">        tcp_connect_init(sk);</span><br><span class="line"><span class="comment">//::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span><br><span class="line">        <span class="comment">/* We change tp-&gt;snd_nxt after the tcp_transmit_skb() call</span><br><span class="line">         * in order to make this packet get counted in tcpOutSegs.</span><br><span class="line">         */</span></span><br><span class="line">        tp-&gt;snd_nxt = tp-&gt;write_seq;</span><br><span class="line">        tp-&gt;pushed_seq = tp-&gt;write_seq;</span><br><span class="line">        TCP_INC_STATS(sock_net(sk), TCP_MIB_ACTIVEOPENS);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">/* Timer for repeating the SYN until an answer. */</span>                         </span><br><span class="line">        inet_csk_reset_xmit_timer(sk, ICSK_TIME_RETRANS,</span><br><span class="line">                                  inet_csk(sk)-&gt;icsk_rto, TCP_RTO_MAX);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Above findings give me some ideas what to look for as next steps.. I will update once I make more progress.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.weiwangblog.com/2015/02/01/2015-02-01_22:39:39/" data-id="cix6p2q5g000r32rzv0zlhipx" class="article-share-link">Share</a>
      
        <a href="http://www.weiwangblog.com/2015/02/01/2015-02-01_22:39:39/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FTACE/">FTACE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/10/07/About-hair/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          关于头发
        
      </div>
    </a>
  
  
    <a href="/2015/01/26/2015-01-26_03:53:47/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">流水</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a><span class="category-list-count">169</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Uncategorized/">Uncategorized</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/music/">music</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">tech</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/旦夕语录/">旦夕语录</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FTACE/">FTACE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Music/">Music</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/friends/">friends</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/">music</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/random/">random</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/">tech</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/travel/">travel</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/乡愁/">乡愁</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/他们在成长/">他们在成长</a><span class="tag-list-count">57</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/出差/">出差</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/有时不易/">有时不易</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/流水帐/">流水帐</a><span class="tag-list-count">30</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/煮人/">煮人</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/胡言/">胡言</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/血脉/">血脉</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/那时白衣飘/">那时白衣飘</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/FTACE/" style="font-size: 10px;">FTACE</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Music/" style="font-size: 10px;">Music</a> <a href="/tags/friends/" style="font-size: 13px;">friends</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/music/" style="font-size: 17px;">music</a> <a href="/tags/random/" style="font-size: 10px;">random</a> <a href="/tags/tech/" style="font-size: 10px;">tech</a> <a href="/tags/travel/" style="font-size: 13px;">travel</a> <a href="/tags/乡愁/" style="font-size: 12px;">乡愁</a> <a href="/tags/他们在成长/" style="font-size: 20px;">他们在成长</a> <a href="/tags/出差/" style="font-size: 16px;">出差</a> <a href="/tags/有时不易/" style="font-size: 14px;">有时不易</a> <a href="/tags/流水帐/" style="font-size: 19px;">流水帐</a> <a href="/tags/煮人/" style="font-size: 15px;">煮人</a> <a href="/tags/胡言/" style="font-size: 16px;">胡言</a> <a href="/tags/血脉/" style="font-size: 18px;">血脉</a> <a href="/tags/那时白衣飘/" style="font-size: 11px;">那时白衣飘</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">February 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/01/">January 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/10/">October 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">May 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/02/">February 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">January 2010</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/12/">December 2009</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/11/">November 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">October 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/09/">September 2009</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/08/">August 2009</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/07/">July 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/06/">June 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/05/">May 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/04/">April 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/03/">March 2009</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/02/">February 2009</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/01/">January 2009</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/10/">October 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/08/">August 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/06/">June 2008</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/05/">May 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/04/">April 2008</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/01/">January 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/12/">December 2007</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/11/">November 2007</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/10/">October 2007</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/09/">September 2007</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/08/">August 2007</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/07/">July 2007</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/06/">June 2007</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/05/">May 2007</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/03/">March 2007</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/02/">February 2007</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/01/">January 2007</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/11/">November 2006</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/10/">October 2006</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/09/">September 2006</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/08/">August 2006</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/07/">July 2006</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/06/">June 2006</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/05/">May 2006</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/12/22/autoimmunereview/">自免疫病学习报告</a>
          </li>
        
          <li>
            <a href="/2016/02/10/unknowns/">醉汉法则与无意识的未知</a>
          </li>
        
          <li>
            <a href="/2016/02/03/Birthday_party_in_dream/">奇妙的生日会</a>
          </li>
        
          <li>
            <a href="/2016/01/17/moon-on-the-abondon-city/">荒城之月</a>
          </li>
        
          <li>
            <a href="/2015/12/07/Reason-not-die/">一首黑暗而光明的歌</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Wei Wang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'wwwweiwangblogcom';
  
  var disqus_url = 'http://www.weiwangblog.com/2015/02/01/2015-02-01_22:39:39/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>